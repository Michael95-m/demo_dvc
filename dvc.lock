schema: '2.0'
stages:
  get_data:
    cmd: python src/stages/data_get.py --config=params.yaml
    deps:
    - path: src/stages/data_get.py
      md5: 40162404985b3cdcbc617f95b0e2b0dd
      size: 1302
    - path: src/stages/utils/log.py
      md5: ec6d9907a691aa06324ad985951b4128
      size: 625
    params:
      params.yaml:
        base:
          random_state: 42
          log_level: INFO
        data_load:
          dataset_zip: health-dataset.zip
          dataset_folder: data/raw
          dataset_csv: data/raw/diabetes_data.csv
    outs:
    - path: data/raw/diabetes_data.csv
      md5: 9a9161518e3622deaa5655b42a2a197b
      size: 5287141
    - path: health-dataset.zip
      md5: aa113db36a5123a20a1cb416d749b130
      size: 1050035
  process_data:
    cmd: python src/process_data.py
    deps:
    - path: health_data/diabetes_data.csv
      md5: 9a9161518e3622deaa5655b42a2a197b
      size: 5287141
    - path: src/process_data.py
      md5: d345803603db975791616971274ae166
      size: 449
    outs:
    - path: Processed_data.csv
      md5: bec80b6142f1c2df04c60b9ab3f75c2d
      size: 4368119
  train:
    cmd: python src/stages/train.py --config params.yaml
    deps:
    - path: data/processed/train.csv
      md5: 6a5c7defbd522ec508be4464727ccb5e
      size: 3453410
    - path: src/stages/train.py
      md5: 12fbc71c7066d589d818c5ddc0ea8fe2
      size: 1716
    - path: src/stages/utils/log.py
      md5: ec6d9907a691aa06324ad985951b4128
      size: 625
    - path: src/stages/utils/train.py
      md5: a303fc36171b81e13a69aac8c09aad2c
      size: 1822
    params:
      params.yaml:
        base:
          random_state: 42
          log_level: INFO
        data_split:
          test_size: 0.3
          trainset_path: data/processed/train.csv
          testset_path: data/processed/test.csv
        featurize:
          feature_folder: data/processed
          features_path: data/processed/featured_data.csv
          drop_features:
          - Veggies
          target_column: Diabetes
        train:
          cv: 3
          estimator_name: randforest
          estimators:
            logreg:
              param_grid:
                C:
                - 0.1
                max_iter:
                - 200
                solver:
                - lbfgs
                multi_class:
                - multinomial
            knn:
              param_grid:
                n_neighbors:
                - 1
                - 3
                - 5
                - 7
                - 9
            xgb:
              param_grid:
                min_child_weight:
                - 1
                gamma:
                - 1
                - 5
                subsample:
                - 1.0
                colsample_bytree:
                - 0.6
                - 1.0
                max_depth:
                - 3
            dectree:
              param_grid:
                criterion:
                - gini
                - entropy
                max_depth:
                - 3
                - 4
                - 5
                - 6
                - 7
                - 8
                - 9
                - 10
            randforest:
              param_grid:
                n_estimators:
                - 100
                max_depth:
                - 11
                min_samples_split:
                - 15
          model_folder: model
          model_path: model/model.joblib
          scaler_path: model/scaler.joblib
    outs:
    - path: model/model.joblib
      md5: 385bcb24edf6a45b0ced982513e5bf5c
      size: 11530465
    - path: model/scaler.joblib
      md5: 034384424b5bd54ec590a37f4caf3f8f
      size: 1606
  featurize:
    cmd: python src/stages/feature_select.py --config params.yaml
    deps:
    - path: data/raw/diabetes_data.csv
      md5: 9a9161518e3622deaa5655b42a2a197b
      size: 5287141
    - path: src/stages/feature_select.py
      md5: 6fd9640f7e4aaa9ae2f81d0476a276ae
      size: 970
    - path: src/stages/utils/log.py
      md5: ec6d9907a691aa06324ad985951b4128
      size: 625
    params:
      params.yaml:
        data_load:
          dataset_zip: health-dataset.zip
          dataset_folder: data/raw
          dataset_csv: data/raw/diabetes_data.csv
        featurize:
          feature_folder: data/processed
          features_path: data/processed/featured_data.csv
          drop_features:
          - Veggies
          target_column: Diabetes
    outs:
    - path: data/processed/featured_data.csv
      md5: d4027581f861aab6fe57755ab8fbfb95
      size: 4933672
  data_split:
    cmd: python src/stages/data_split.py --config params.yaml
    deps:
    - path: data/processed/featured_data.csv
      md5: d4027581f861aab6fe57755ab8fbfb95
      size: 4933672
    - path: src/stages/data_split.py
      md5: 9fcc6fdc4a61f04352b8f5d6653283ee
      size: 1164
    - path: src/stages/utils/log.py
      md5: ec6d9907a691aa06324ad985951b4128
      size: 625
    params:
      params.yaml:
        base:
          random_state: 42
          log_level: INFO
        data_split:
          test_size: 0.3
          trainset_path: data/processed/train.csv
          testset_path: data/processed/test.csv
        featurize:
          feature_folder: data/processed
          features_path: data/processed/featured_data.csv
          drop_features:
          - Veggies
          target_column: Diabetes
    outs:
    - path: data/processed/test.csv
      md5: 55384cfd635be459af11e2738b3d5fd5
      size: 1480417
    - path: data/processed/train.csv
      md5: 6a5c7defbd522ec508be4464727ccb5e
      size: 3453410
  evaluate:
    cmd: python src/stages/evaluate.py --config params.yaml
    deps:
    - path: data/processed/test.csv
      md5: 55384cfd635be459af11e2738b3d5fd5
      size: 1480417
    - path: model/model.joblib
      md5: 385bcb24edf6a45b0ced982513e5bf5c
      size: 11530465
    - path: model/scaler.joblib
      md5: 034384424b5bd54ec590a37f4caf3f8f
      size: 1606
    - path: src/stages/evaluate.py
      md5: d3a78f28c3e8296fe0f27558c315118f
      size: 2233
    - path: src/stages/utils/evaluate.py
      md5: e5ca8d01d89cf7183052dbaf4dfd82cc
      size: 1437
    - path: src/stages/utils/log.py
      md5: ec6d9907a691aa06324ad985951b4128
      size: 625
    params:
      params.yaml:
        data_split:
          test_size: 0.3
          trainset_path: data/processed/train.csv
          testset_path: data/processed/test.csv
        evaluate:
          report_folder: report
          accuracy_report_path: report/report.json
          confusion_matrix_path: report/confusion_matrix.png
          translated_report_path: report/confusion_matrix_data.csv
          target_names:
          - no_diabetes
          - diabetes
        featurize:
          feature_folder: data/processed
          features_path: data/processed/featured_data.csv
          drop_features:
          - Veggies
          target_column: Diabetes
        train:
          cv: 3
          estimator_name: randforest
          estimators:
            logreg:
              param_grid:
                C:
                - 0.1
                max_iter:
                - 200
                solver:
                - lbfgs
                multi_class:
                - multinomial
            knn:
              param_grid:
                n_neighbors:
                - 1
                - 3
                - 5
                - 7
                - 9
            xgb:
              param_grid:
                min_child_weight:
                - 1
                gamma:
                - 1
                - 5
                subsample:
                - 1.0
                colsample_bytree:
                - 0.6
                - 1.0
                max_depth:
                - 3
            dectree:
              param_grid:
                criterion:
                - gini
                - entropy
                max_depth:
                - 3
                - 4
                - 5
                - 6
                - 7
                - 8
                - 9
                - 10
            randforest:
              param_grid:
                n_estimators:
                - 100
                max_depth:
                - 11
                min_samples_split:
                - 15
          model_folder: model
          model_path: model/model.joblib
          scaler_path: model/scaler.joblib
    outs:
    - path: report/confusion_matrix.png
      md5: 80998413c12941bd1c5255c5045d1b70
      size: 24330
    - path: report/confusion_matrix_data.csv
      md5: c71914a1fe918e1a2f9c628a7b965169
      size: 442637
    - path: report/report.json
      md5: 26c0ad638b83e8171689c5d2453132a4
      size: 77
